"use strict";(self["webpackChunkbamxx"]=self["webpackChunkbamxx"]||[]).push([[788],{4834:(e,t,i)=>{i.d(t,{Z:()=>Z});var a=i(3673);const o={class:"full-width row justify-between q-py-lg q-px-xl"},s={class:"col-6 col-md-11 flex"},l=(0,a._)("span",{class:"dialog__title q-my-auto q-pl-md text-h5"}," Importar beneficiarios ",-1),r={class:"col-6 col-md-1 flex"},n={class:"q-py-xl q-px-xl"},c=(0,a._)("div",{class:"text-h6"}," Archivo ",-1),d=(0,a._)("div",null,[(0,a.Uk)(" * El archivo tiene que ser el original que se genera en "),(0,a._)("a",{href:"https://sigoplus.bamx.org.mx/",target:"_blank",class:"text-red"}," SIGO+ ")],-1),u={class:"column content-center"};function p(e,t,i,p,m,f){const h=(0,a.up)("q-icon"),b=(0,a.up)("q-btn"),g=(0,a.up)("q-file"),y=(0,a.up)("q-form"),w=(0,a.up)("q-card-section"),q=(0,a.up)("q-card"),v=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(q,{class:"dialog full-width column"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"full-width column"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a._)("div",s,[(0,a.Wm)(h,{name:"file_upload",size:"300%"}),l]),(0,a._)("div",r,[(0,a.wy)((0,a.Wm)(b,{class:"q-ml-auto",size:"md",icon:"cancel",flat:"",round:""},null,512),[[v]])])]),(0,a._)("div",n,[c,(0,a.Wm)(g,{outlined:"",class:"dialog__upload q-my-md",modelValue:m.file,"onUpdate:modelValue":t[0]||(t[0]=e=>m.file=e),accept:".xls, .xlsx",onRejected:t[1]||(t[1]=e=>f.error("Solo se permiten archivos .xls o .xlsx"))},{prepend:(0,a.w5)((()=>[(0,a.Wm)(h,{name:"attach_file"})])),_:1},8,["modelValue"]),d]),(0,a._)("div",u,[(0,a.Wm)(b,{size:"lg",push:"",icon:"check",color:"green",label:"Confirmar",onClick:t[2]||(t[2]=e=>f.importBeneficiary())})])])),_:1})])),_:1})])),_:1})}var m=i(5474),f=i(6249);const h={data(){return{file:null}},methods:{success(e){this.$q.notify({message:e,icon:"done",color:"green"})},error(e){this.$q.notify({message:e,icon:"error",color:"red"})},importBeneficiary(){f.Z.show();let e=new FormData;e.append("xlsx",this.file),m.api.post("api/beneficiary/import",e,{headers:{"x-access-token":this.$store.getters.token,"Content-Type":"multipart/form-data"}}).then((e=>{f.Z.hide(),this.$emit("close-modal"),m.api.get("api/beneficiary/import/finish",{headers:{"x-access-token":this.$store.getters.token}}).then((e=>{location.reload()})).catch((e=>{this.error("Error al importar el archivo. Inténtelo de nuevo"),401==e.status&&(this.$store.commit("updateAuth",{auth:!1}),this.$router.push("login"))}))})).catch((e=>{f.Z.hide(),this.error("Error al importar el archivo. Inténtelo de nuevo"),401==e.status&&(this.$store.commit("updateAuth",{auth:!1}),this.$router.push("login"))}))}}};var b=i(4260),g=i(151),y=i(5589),w=i(8689),q=i(4554),v=i(8240),k=i(1052),x=i(677),_=i(7518),V=i.n(_);const B=(0,b.Z)(h,[["render",p]]),Z=B;V()(h,"components",{QCard:g.Z,QCardSection:y.Z,QForm:w.Z,QIcon:q.Z,QBtn:v.Z,QFile:k.Z}),V()(h,"directives",{ClosePopup:x.Z})},5395:(e,t,i)=>{i.r(t),i.d(t,{default:()=>fe});var a=i(3673);function o(e,t,i,o,s,l){const r=(0,a.up)("beneficiaryTable");return(0,a.wg)(),(0,a.j4)(r,{onEditBeneficiary:l.editBeneficiary,beneficiaries:{beneficiaryList:s.beneficiaryList},search:!0,importBtn:!0},null,8,["onEditBeneficiary","beneficiaries"])}var s=i(5474),l=i(6249),r=i(2323);const n={class:"q-pa-md"},c={class:"text-uppercase"},d=(0,a.Uk)(" Activo "),u=(0,a.Uk)(" Inactivo "),p={key:0},m={key:1},f={key:0},h={key:1},b=(0,a.Uk)(" Editar "),g={class:"col q-pa-md q-gutter-sm"},y={class:"q-pa-sm flex justify-end"};function w(e,t,i,o,s,l){const w=(0,a.up)("q-td"),q=(0,a.up)("q-badge"),v=(0,a.up)("q-tooltip"),k=(0,a.up)("q-btn"),x=(0,a.up)("q-tr"),_=(0,a.up)("ImportBeneficiaries"),V=(0,a.up)("q-dialog"),B=(0,a.up)("q-icon"),Z=(0,a.up)("q-input"),C=(0,a.up)("q-table"),E=(0,a.up)("EditBeneficiary");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",c,[(0,a.Wm)(C,{"title-class":"title",title:"Beneficiarios",rows:s.rows,filter:s.filter,grid:e.$q.screen.xs,columns:o.columns,"row-key":"name",flat:"",bordered:"","no-data-label":"Sin información disponible","no-results-label":"Sin coincidencias"},{body:(0,a.w5)((e=>[(0,a.Wm)(x,{props:e},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{key:"Id",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(e.row.Id),1)])),_:2},1032,["props"]),(0,a.Wm)(w,{key:"name",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(e.row.name),1)])),_:2},1032,["props"]),(0,a.Wm)(w,{key:"groupName",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(e.row.groupName),1)])),_:2},1032,["props"]),(0,a.Wm)(w,{key:"communityName",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(e.row.communityName),1)])),_:2},1032,["props"]),(0,a.Wm)(w,{key:"status",props:e},{default:(0,a.w5)((()=>["active"==e.row.status?((0,a.wg)(),(0,a.j4)(q,{key:0,color:"green"},{default:(0,a.w5)((()=>[d])),_:1})):((0,a.wg)(),(0,a.j4)(q,{key:1,color:"red"},{default:(0,a.w5)((()=>[u])),_:1}))])),_:2},1032,["props"]),(0,a.Wm)(w,{key:"address",props:e},{default:(0,a.w5)((()=>[e.row.address?((0,a.wg)(),(0,a.iD)("div",p,(0,r.zw)(e.row.address),1)):((0,a.wg)(),(0,a.iD)("div",m," No disponible"))])),_:2},1032,["props"]),(0,a.Wm)(w,{key:"phone",props:e},{default:(0,a.w5)((()=>[e.row.phone?((0,a.wg)(),(0,a.iD)("div",f,(0,r.zw)(e.row.phone),1)):((0,a.wg)(),(0,a.iD)("div",h," No disponible"))])),_:2},1032,["props"]),(0,a.Wm)(w,{key:"actions",props:e},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{flat:"",round:"",color:"gray",icon:"edit",onClick:t=>l.editBeneficiary(e.row)},{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[b])),_:1})])),_:2},1032,["onClick"])])),_:2},1032,["props"])])),_:2},1032,["props"])])),"top-right":(0,a.w5)((()=>[(0,a._)("div",g,[i.xls?((0,a.wg)(),(0,a.j4)(k,{key:0,color:"green-9","icon-right":"description",label:"Descargar xls","no-caps":"",onClick:t[0]||(t[0]=e=>l.exportTable(!0))})):(0,a.kq)("",!0),i.csv?((0,a.wg)(),(0,a.j4)(k,{key:1,color:"yellow-8","icon-right":"archive",label:"Descargar csv","no-caps":"",onClick:t[1]||(t[1]=e=>l.exportTable(!1))})):(0,a.kq)("",!0),i.reports?((0,a.wg)(),(0,a.j4)(k,{key:2,color:"blue-9","icon-right":"summarize",label:"Generar Reporte","no-caps":""})):(0,a.kq)("",!0),i.importBtn?((0,a.wg)(),(0,a.j4)(k,{key:3,color:"red","icon-right":"file_upload",label:"Importar","no-caps":"",onClick:t[2]||(t[2]=e=>o.importBeneficiaries=!0)})):(0,a.kq)("",!0),(0,a.Wm)(V,{modelValue:o.importBeneficiaries,"onUpdate:modelValue":t[3]||(t[3]=e=>o.importBeneficiaries=e),persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{onCloseModal:l.closeImportModal},null,8,["onCloseModal"])])),_:1},8,["modelValue"])]),i.search?((0,a.wg)(),(0,a.j4)(Z,{key:0,borderless:"",dense:"",debounce:"300",modelValue:s.filter,"onUpdate:modelValue":t[4]||(t[4]=e=>s.filter=e),placeholder:"Buscar"},{append:(0,a.w5)((()=>[(0,a.Wm)(B,{name:"search"})])),_:1},8,["modelValue"])):(0,a.kq)("",!0)])),_:1},8,["rows","filter","grid","columns"]),(0,a.Wm)(V,{modelValue:s.editBeneficiaryCard,"onUpdate:modelValue":t[5]||(t[5]=e=>s.editBeneficiaryCard=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{beneficiaryData:o.beneficiaryData,onEditBeneficiary:l.editedBeneficiary},null,8,["beneficiaryData","onEditBeneficiary"])])),_:1},8,["modelValue"])]),(0,a._)("div",y,[i.info?((0,a.wg)(),(0,a.j4)(k,{key:0,color:"primary","icon-right":"arrow_forward",label:"Ver mas información",onClick:t[6]||(t[6]=e=>l.redirect())})):(0,a.kq)("",!0)])])}const q={class:"full-width row justify-between q-py-lg q-px-lg"},v={class:"col-12 col-md-11 flex"},k=(0,a._)("span",{class:"beneficiaryCard__title q-my-auto q-pl-sm"}," Editar beneficiario ",-1),x={class:"row q-py-lg q-px-md text-h6"},_={class:"col-12 q-px-md"},V=(0,a.Uk)(" Titular "),B={class:"col-12 q-px-md"},Z=(0,a.Uk)(" Dirección "),C={class:"col-12 col-sm-6 q-px-md"},E=(0,a.Uk)(" Comunidad "),W={class:"col-12 col-sm-6 q-px-md"},N=(0,a.Uk)(" Grupo "),I={class:"col-12 col-sm-6 q-px-md"},U=(0,a.Uk)(" Folio de la familia "),$={class:"col-12 col-sm-6 q-px-md"},Q=(0,a.Uk)(" Estatus "),j={class:"col-12 q-px-md"},z=(0,a.Uk)(" Teléfono "),D={class:"row justify-center q-my-auto"};function S(e,t,i,o,s,l){const r=(0,a.up)("q-icon"),n=(0,a.up)("q-input"),c=(0,a.up)("q-select"),d=(0,a.up)("q-btn"),u=(0,a.up)("q-form"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-card"),f=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(m,{class:"beneficiaryCard column"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"q-px-md full-height column"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a._)("div",q,[(0,a._)("div",v,[(0,a.Wm)(r,{name:"account_circle",size:"300%"}),k])]),(0,a._)("div",x,[(0,a._)("div",_,[V,(0,a.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:s.benefit.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.benefit.name=e),type:"text","lazy-rules":"",rules:[e=>!!e||"Campo Obligatorio",e=>l.isValidInput(e)||"Entrada no válida. Solo se aceptan letras"]},null,8,["modelValue","rules"])]),(0,a._)("div",B,[Z,(0,a.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:s.benefit.address,"onUpdate:modelValue":t[1]||(t[1]=e=>s.benefit.address=e),type:"text","lazy-rules":"",rules:[e=>!!e||"Campo Obligatorio",e=>l.isValidAddress(e)||"Ingrese una dirección válida"]},null,8,["modelValue","rules"])]),(0,a._)("div",C,[E,(0,a.Wm)(c,{class:"q-py-md",outlined:"",modelValue:s.benefit.communityName,"onUpdate:modelValue":t[2]||(t[2]=e=>s.benefit.communityName=e),type:"text",options:o.optCommunity},null,8,["modelValue","options"])]),(0,a._)("div",W,[N,(0,a.Wm)(c,{class:"q-py-md",outlined:"",modelValue:s.benefit.groupName,"onUpdate:modelValue":t[3]||(t[3]=e=>s.benefit.groupName=e),type:"text",options:o.optGroup},null,8,["modelValue","options"])]),(0,a._)("div",I,[U,(0,a.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:s.benefit.Id,"onUpdate:modelValue":t[4]||(t[4]=e=>s.benefit.Id=e),type:"text",readonly:"",disable:""},null,8,["modelValue"])]),(0,a._)("div",$,[Q,(0,a.Wm)(c,{class:"q-py-md",outlined:"",modelValue:s.benefit.status,"onUpdate:modelValue":t[5]||(t[5]=e=>s.benefit.status=e),type:"text",options:o.optStatus},null,8,["modelValue","options"])]),(0,a._)("div",j,[z,(0,a.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:s.benefit.phone,"onUpdate:modelValue":t[6]||(t[6]=e=>s.benefit.phone=e),type:"text",mask:"##########"},null,8,["modelValue"])])]),(0,a._)("div",D,[(0,a.wy)((0,a.Wm)(d,{class:"q-px-md q-ma-md",size:"md",push:"",icon:"cancel",color:"red",label:"Cancelar"},null,512),[[f,2]]),(0,a.wy)((0,a.Wm)(d,{class:"q-px-md q-ma-md",size:"md",push:"",type:"submit",icon:"check",color:"green",label:"Guardar",onClick:t[7]||(t[7]=e=>l.saveEditedBenef())},null,512),[[f]])])])),_:1})])),_:1})])),_:1})}const A={name:"EditBeneficiary",props:{beneficiaryData:Object},data(){return{benefit:{},communities:[],communityDay:[]}},setup(){return{optStatus:["activo","inactivo"],optGroup:["Vergel lunes","Vergel martes","Vergel miércoles","Vergel Jueves","Vergel viernes","Voluntarias"],optCommunity:["VERGEL"]}},mounted(){this.benefit=JSON.parse(JSON.stringify(this.beneficiaryData)),"active"==this.benefit.status?this.benefit.status="activo":"disabled"==this.benefit.status&&this.benefit.status},methods:{success(e){this.$q.notify({message:e,icon:"done",color:"green"})},saveEditedBenef(){let e;"Vergel lunes"==this.benefit.groupName||"vergel lunes"==this.benefit.groupName?e=1:"Vergel martes"==this.benefit.groupName||"VEGEL MARTES"==this.benefit.groupName?e=2:"Vergel miércoles"==this.benefit.groupName||"VERGEL MIERCOLES"==this.benefit.groupName?e=3:"Vergel jueves"==this.benefit.groupName||"VEGEL JUEVES"==this.benefit.groupName?e=4:"Vergel viernes"==this.benefit.groupName||"VERGEL VIERNES"==this.benefit.groupName?e=5:"Vergel"!=this.benefit.groupName&&"VERGEL"!=this.benefit.groupName||(e=6),"activo"==this.benefit.status?this.benefit.status="active":"inactivo"==this.benefit.status&&(this.benefit.status="disabled"),""==this.benefit.phone&&(this.benefit.phone=null);const t={address:this.benefit.address,name:this.benefit.name,phone:this.benefit.phone,group_id:e,status:this.benefit.status};s.api.patch("api/beneficiary/"+this.benefit.Id,t,{headers:{"x-access-token":this.$store.getters.token}}).then((e=>{this.success("Beneficiario editado correctamente"),this.$emit("edit-beneficiary",this.benefit)})).catch((e=>{this.error("Error al editar el beneficiario, inténtelo de nuevo."),401==e.status?(this.$store.commit("updateAuth",{auth:!1}),this.$router.push("login")):this.error(e.response.data.Message)}))},error(e){this.$q.notify({message:e,icon:"error",color:"red"})},isValidInput(e){const t=/^.[.a-zA-ZÀ-ÿ\u00f1\u00d1]+(\s*[.a-zA-ZÀ-ÿ\u00f1\u00d1]*)*[.a-zA-ZÀ-ÿ\u00f1\u00d1]+$/;return t.test(String(e))},isValidAddress(e){const t=/^(?=.*\d*[a-zA-Z])(?=.*[a-zA-Z]).{1,}$/;return t.test(String(e))}},beforeCreate(){}};var T=i(4260),G=i(151),L=i(5589),F=i(8689),R=i(4554),M=i(4689),O=i(5863),J=i(8240),P=i(677),H=i(7518),K=i.n(H);const X=(0,T.Z)(A,[["render",S]]),Y=X;K()(A,"components",{QCard:G.Z,QCardSection:L.Z,QForm:F.Z,QIcon:R.Z,QInput:M.Z,QSelect:O.Z,QBtn:J.Z}),K()(A,"directives",{ClosePopup:P.Z});var ee=i(4834),te=(i(1082),i(1959));const ie=[{name:"Id",required:!0,align:"left",label:"Folio",field:"Id",sortable:!0},{name:"name",align:"left",label:"Nombre",field:"name",sortable:!0},{name:"groupName",align:"left",label:"Grupo",field:"groupName",sortable:!0},{name:"communityName",align:"left",label:"Comunidad",field:"communityName"},{name:"status",align:"left",label:"Estatus",field:"status",sortable:!0},{name:"address",align:"left",label:"Dirección",field:"address",sortable:!0},{name:"phone",align:"left",label:"Teléfono",field:"phone",sortable:!1},{name:"actions",label:"Acciones",field:"acciones",sortable:!0}],ae={components:{ImportBeneficiaries:ee.Z,EditBeneficiary:Y},props:{beneficiaries:Object,title:String,csv:Boolean,xls:Boolean,search:Boolean,reports:Boolean,importBtn:Boolean,buttons:Boolean,info:Boolean,redirectTo:String},data(){return{filter:(0,te.iH)(""),rows:[],editBeneficiaryCard:(0,te.iH)(!1)}},setup(){return{columns:ie,importBeneficiaries:(0,te.iH)(!1),beneficiaryData:[]}},methods:{redirect(){this.$router.push(this.$props.redirectTo)},editedBeneficiary(e){this.$emit("edit-beneficiary",e)},editBeneficiary(e){this.beneficiaryData=e,this.editBeneficiaryCard=!0},exportTable(e){const t=[this.columns.map((e=>wrapCsvValue(e.label)))].concat(this.rows.map((e=>this.columns.map((t=>wrapCsvValue("function"===typeof t.field?t.field(e):e[void 0===t.field?t.name:t.field],t.format,e))).join(",")))).join("\r\n");let i=!0===e?this.$props.title+".xls":this.$props.title+".csv",a=!0===e?"text/xsl":"text/csv";const o=exportFile(i,t,a);!0!==o&&$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},closeImportModal(){this.importBeneficiaries=!1}},beforeUpdate(){this.rows=this.$props.beneficiaries.beneficiaryList}};var oe=i(9178),se=i(8186),le=i(3884),re=i(9721),ne=i(8870),ce=i(6778);const de=(0,T.Z)(ae,[["render",w]]),ue=de;K()(ae,"components",{QTable:oe.Z,QTr:se.Z,QTd:le.Z,QBadge:re.Z,QBtn:J.Z,QTooltip:ne.Z,QDialog:ce.Z,QInput:M.Z,QIcon:R.Z});const pe={name:"AdminDashboard",components:{BeneficiaryTable:ue},created(){this.getBeneficiaries()},methods:{editBeneficiary(e){let t=this.beneficiaryList.findIndex((t=>t.Id===e.Id));this.beneficiaryList.splice(t,1,e)},getBeneficiaries(){l.Z.show(),s.api.get("api/beneficiary",{headers:{"x-access-token":this.$store.getters.token}}).then((e=>{this.beneficiaryList=e.data,l.Z.hide()})).catch((e=>{l.Z.hide(),401==e.response.status?(this.$store.commit("updateAuth",{auth:!1}),this.$router.push("login")):this.error(e.response.data.Message)}))}},data(){return{beneficiaryList:[],cols:["Folio","Nombre","Apellidos","Comunidad","Grupo","Fecha de entrega","Paquete entregado","Producto extra"],rows:[]}}},me=(0,T.Z)(pe,[["render",o]]),fe=me}}]);